# 数据库功能说明

## 📁 文件夹结构

```
database/
├── scenarios/          # 情境数据
├── sentences/          # 句子数据
├── qa_records/         # 问答记录
├── user_progress/      # 用户进度
├── backup/            # 数据备份
└── save_data.js       # 数据库管理器
```

## 🎯 功能特性

### 数据保存
- **情境数据**：保存到 `scenarios/` 文件夹
- **句子数据**：保存到 `sentences/` 文件夹
- **问答记录**：保存到 `qa_records/` 文件夹
- **用户进度**：保存到 `user_progress/` 文件夹

### 数据管理
- **自动备份**：每次保存数据时自动创建备份
- **数据导出**：支持导出为JSON格式
- **数据导入**：支持从JSON文件导入数据
- **数据恢复**：支持从备份文件恢复数据

## 🔧 使用方法

### 添加情境
1. 点击"添加情境"按钮
2. 输入情境名称和选择图标
3. 数据自动保存到 `database/scenarios/` 文件夹

### 添加句子
1. 点击"添加句子"按钮
2. 选择情境和难度等级
3. 输入中文句子，AI生成日语
4. 数据自动保存到 `database/sentences/` 文件夹

### 问答记录
1. 在问答记录页面输入问题和答案
2. 点击保存按钮
3. 数据自动保存到 `database/qa_records/` 文件夹

### 数据管理
- **备份数据**：点击"备份数据"按钮
- **导出数据**：点击"导出数据"按钮下载JSON文件
- **导入数据**：点击"导入数据"按钮选择JSON文件

## 📊 数据格式

### 情境数据格式
```json
{
  "id": "scenario_id",
  "name": "情境名称",
  "icon": "图标类名",
  "created_at": "创建时间",
  "updated_at": "更新时间",
  "sentences": []
}
```

### 句子数据格式
```json
{
  "id": "sentence_id",
  "scenario": "情境ID",
  "level": "难度等级",
  "chinese": "中文句子",
  "hiragana": "平假名",
  "kanji": "汉字+平假名",
  "grammar": "语法点",
  "created_at": "创建时间",
  "review_count": 0,
  "last_reviewed": null
}
```

### 问答数据格式
```json
{
  "id": "qa_id",
  "question": "问题",
  "answer": "答案",
  "created_at": "创建时间",
  "category": "分类",
  "tags": []
}
```

## 🚀 技术实现

### 前端保存
- 使用 `localStorage` 进行临时存储
- 实时同步到数据库文件夹
- 支持离线使用

### 后端保存
- 模拟文件系统操作
- 支持JSON格式数据
- 自动生成时间戳

### 数据同步
- 前端和后端数据同步
- 支持数据导入导出
- 自动备份机制

## 📝 注意事项

1. **数据安全**：所有数据都会自动备份
2. **格式兼容**：支持标准JSON格式
3. **版本控制**：每次保存都会生成新的时间戳
4. **错误处理**：保存失败时会显示错误信息

## 🔄 数据迁移

### 从旧版本迁移
1. 导出旧版本数据
2. 使用导入功能导入新版本
3. 数据会自动转换格式

### 数据恢复
1. 从备份文件夹选择备份文件
2. 使用导入功能恢复数据
3. 确认数据完整性
